# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Telegram ID

## 1. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
./stop-project.sh

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
./rebuild-project.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
./start-project.sh
```

–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—Ñ–∞–π–ª `init-db/05-add-telegram-auth.sql`).

## 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î. 

### –°–ø–æ—Å–æ–± A: –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PostgreSQL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –ë–î
docker exec -it procurement-db psql -U procurement_user -d procurement_db

# –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∑–∞–º–µ–Ω–∏—Ç–µ YOUR_TELEGRAM_ID –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
INSERT INTO users (username, telegram_id) 
VALUES ('admin', YOUR_TELEGRAM_ID)
ON CONFLICT (telegram_id) DO NOTHING;

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω
SELECT * FROM users WHERE telegram_id IS NOT NULL;

# –í—ã—Ö–æ–¥
\q
```

### –°–ø–æ—Å–æ–± B: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç PostgreSQL –Ω–∞ —Ö–æ—Å—Ç –º–∞—à–∏–Ω–µ

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ PostgreSQL –∫–ª–∏–µ–Ω—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
psql --version

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î
psql -h 127.0.0.1 -p 5432 -U procurement_user -d procurement_db

# –í—ã–ø–æ–ª–Ω–∏—Ç—å —Ç–æ—Ç –∂–µ SQL –∫–∞–∫ –≤—ã—à–µ
```

## 3. –ü–æ–ª—É—á–µ–Ω–∏–µ Telegram ID

–ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

1. **–°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ –±–æ—Ç–∞ (—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π)**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –≤ Telegram: [@userinfobot](https://t.me/userinfobot)
   - –ù–∞–∂–º–∏—Ç–µ START
   - –ë–æ—Ç –≤–µ—Ä–Ω–µ—Ç –≤–∞—à ID –≤ –ø–æ–ª–µ `Id` (—á–∏—Å–ª–æ)

2. **–°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ Web –≤–µ—Ä—Å–∏—é Telegram**
   - –û—Ç–∫—Ä–æ–π—Ç–µ web.telegram.org
   - –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12)
   - –í –∫–æ–Ω—Å–æ–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: `Telegram.User.id`
   - –ë—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω –≤–∞—à Telegram ID

## 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Telegram** (–ø–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π –Ω–∞ Mini App –∏–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ –±–æ—Ç–∞)
2. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è** –µ—Å–ª–∏ –≤–∞—à Telegram ID –µ—Å—Ç—å –≤ –ë–î
3. **–ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω Telegram ID –≤ –ë–î
   - –°–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ ID –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å ID –≤ –ë–î

## 5. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î
docker exec -it procurement-db psql -U procurement_user -d procurement_db

# –î–æ–±–∞–≤–∏—Ç—å –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
INSERT INTO users (username, telegram_id) 
VALUES ('–∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 123456789);

# –ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ä–∞–∑—É
INSERT INTO users (username, telegram_id) 
VALUES 
  ('user1', 123456789),
  ('user2', 987654321),
  ('user3', 555555555);

\q
```

## 6. –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

```bash
docker exec -it procurement-db psql -U procurement_user -d procurement_db

SELECT id, username, telegram_id, created_at 
FROM users 
WHERE telegram_id IS NOT NULL
ORDER BY created_at DESC;

\q
```

## 7. –£–¥–∞–ª–µ–Ω–∏–µ/–∑–∞–ø—Ä–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
docker exec -it procurement-db psql -U procurement_user -d procurement_db

-- –°–ø–æ—Å–æ–± 1: –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–ª–Ω–æ—Å—Ç—å—é
DELETE FROM users WHERE telegram_id = 123456789;

-- –°–ø–æ—Å–æ–± 2: –¢–æ–ª—å–∫–æ –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –¥–æ—Å—Ç—É–ø (–æ—Å—Ç–∞–≤–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é)
UPDATE users SET telegram_id = NULL WHERE id = 5;

\q
```

## 8. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ

–ï—Å–ª–∏ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ –∏ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–µ–π–∫–æ–≤—ã–π Telegram ID
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `apiService.ts` –≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```typescript
getTelegramData() {
  // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ
  if (window.location.hostname === 'localhost') {
    return { 
      id: 123456789,  // –í–∞—à —Ç–µ—Å—Ç–æ–≤—ã–π ID
      first_name: 'Test'
    };
  }
  
  const tg = (window as any).Telegram?.WebApp;
  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Telegram Mini App localhost
1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/botfather)
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç ngrok –¥–ª—è –ø—Ä–æ–±—Ä–æ—Å–∞ localhost
4. –û—Ç–∫—Ä–æ–π—Ç–µ Mini App —á–µ—Ä–µ–∑ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ —Å localhost URL

## 9. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –≤:

### –ù–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ (–≤ –±—Ä–∞—É–∑–µ—Ä–µ):
- F12 ‚Üí Console
- –ò—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏: `üîê`, `‚úÖ`, `‚ùå`

### –ù–∞ –±—ç–∫–µ–Ω–¥–µ:
```bash
docker logs procurement-backend | grep -E "(–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü|–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å|–î–æ—Å—Ç—É–ø)"
```

## 10. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| –ò—Å—Ç–æ—á–Ω–∏–∫ ID | Telegram WebApp API | –ë–µ—Ä–µ—Ç—Å—è –∏–∑ initData |
| –•—Ä–∞–Ω–∏–ª–∏—â–µ | localStorage | telegram_id —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –ù–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∫ API | –ó–∞–≥–æ–ª–æ–≤–æ–∫ `X-Telegram-Id` |
| –í—Ä–µ–º—è —Å–µ—Å—Å–∏–∏ | –î–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã | –°–µ—Å—Å–∏—è –Ω–µ –∏—Å—Ç–µ–∫–∞–µ—Ç |
| –ó–∞—â–∏—Ç–∞ | –°–ø–∏—Å–æ–∫ –≤ –ë–î | –¢–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ |

## 11. –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –∫–æ–¥–µ

### –ë—ç–∫–µ–Ω–¥
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `models/auth.js` - middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `routes/auth.js` - endpoints –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `server.js` - –ø–æ–¥–∫–ª—é—á–µ–Ω—ã auth routes –∏ middleware
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã `routes/lists.js` –∏ `routes/items.js` - –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `init-db/05-add-telegram-auth.sql`

### –§—Ä–æ–Ω—Ç–µ–Ω–¥
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `services/apiService.ts` - –º–µ—Ç–æ–¥—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ–¥–∞—á–∞ telegram_id
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `App.tsx` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏ —ç–∫—Ä–∞–Ω –æ—à–∏–±–∫–∏

## 12. –ü–æ—Ä—Ç—ã –∏ URL

- **–§—Ä–æ–Ω—Ç–µ–Ω–¥**: https://procurement.fros-ty.com –∏–ª–∏ http://localhost:3000
- **–ë—ç–∫–µ–Ω–¥ API**: https://procurement.fros-ty.com/api –∏–ª–∏ http://localhost:3002/api
- **Auth endpoints**: `/api/auth/check`, `/api/auth/me`

## 13. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### "–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω. –í–∞—à Telegram ID –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω"
‚úì –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Telegram ID –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü—É `users`
‚úì –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚úì –û—á–∏—Å—Ç–∏—Ç–µ localStorage: F12 ‚Üí Application ‚Üí Clear storage

### "–¢–µ–ª–µ–≥—Ä–∞–º –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
‚úì –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ –≤ Telegram Mini App –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
‚úì –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–æ –≤—ã—à–µ
‚úì –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp —Ä–∞–±–æ—Ç–∞–µ—Ç

### "–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ Telegram –¥–∞–Ω–Ω—ã—Ö"
‚úì –í–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª–µ `initData` –∏–º–µ–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
‚úì –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é Telegram –∏ –æ–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401 –∏–ª–∏ 403
‚úì –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Telegram-Id` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è
‚úì –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ apiService –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
‚úì –û—á–∏—Å—Ç–∏—Ç–µ localStorage –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ—Å—å

## 14. –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
